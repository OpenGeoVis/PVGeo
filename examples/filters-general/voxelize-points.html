

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Voxelize Points &mdash; PVGeo  documentation</title>
  

  
  
  
  
    <link rel="canonical" href="http://docs.pvgeo.org/examples/filters-general/voxelize-points.html"/>
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script>
        <script type="text/javascript" src="../../_static/copybutton.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/copybutton.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Extract Topography" href="../grids/extract-topography.html" />
    <link rel="prev" title="Rotate Points" href="rotate-points.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> PVGeo
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../index.html">Welcome to PVGeo’s code docs!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/why-pvgeo.html">Why PVGeo?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/featured.html">Featured</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview/agu-2018.html">AGU 2018</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../about-examples.html">About Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Quick Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#general-filters">General Filters</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="add-cell-connectivity-to-points.html">Add Cell Connectivity To Points</a></li>
<li class="toctree-l3"><a class="reference internal" href="append-cell-centers.html">Append Cell Centers</a></li>
<li class="toctree-l3"><a class="reference internal" href="array-math.html">Array Math</a></li>
<li class="toctree-l3"><a class="reference internal" href="combine-tables.html">Combine Tables</a></li>
<li class="toctree-l3"><a class="reference internal" href="extract-array.html">Extract Array to Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="extract-points.html">Extract Points</a></li>
<li class="toctree-l3"><a class="reference internal" href="many-slices-along-points.html">Many Slices Along Points</a></li>
<li class="toctree-l3"><a class="reference internal" href="normalize-array.html">Normalize Array</a></li>
<li class="toctree-l3"><a class="reference internal" href="points-to-tube.html">Points to Tube</a></li>
<li class="toctree-l3"><a class="reference internal" href="reshape-table.html">Reshape Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="rotate-points.html">Rotate Points</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Voxelize Points</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#points-to-voxelized-volume">Points to Voxelized Volume</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filter-volumetric-data">Filter Volumetric Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#grids">Grids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#gslib">GSLib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#ubc-data-formats">UBC Data Formats</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Index:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../content/PVGeo/index.html">About PVGeo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../content/pvmacros/index.html">About ParaView Macros</a></li>
</ul>
<p class="caption"><span class="caption-text">Development Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../dev-guide/contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-guide/repo-structure.html">Project Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-guide/templates.html">Templates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-guide/snippets/index.html">Development Example Snippets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-guide/resources.html">External References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">PVGeo</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Quick Examples</a> &raquo;</li>
        
      <li>Voxelize Points</li>
    
    

  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-filters-general-voxelize-points-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="voxelize-points">
<span id="sphx-glr-examples-filters-general-voxelize-points-py"></span><h1>Voxelize Points<a class="headerlink" href="#voxelize-points" title="Permalink to this headline">¶</a></h1>
<p>This example will demonstrate how to connect a set of points defined on a
regular grid to create a <cite>vtkUnstructuredGrid</cite> which can be used to perform
volumetric operations.</p>
<p>This example demos <code class="xref py py-class docutils literal notranslate"><span class="pre">PVGeo.filters.VoxelizePoints</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 2</span>
<span class="kn">import</span> <span class="nn">pyvista</span>
<span class="kn">from</span> <span class="nn">pyvista</span> <span class="k">import</span> <span class="n">examples</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">PVGeo</span>
<span class="kn">from</span> <span class="nn">PVGeo.filters</span> <span class="k">import</span> <span class="n">VoxelizePoints</span>
</pre></div>
</div>
<p>Download sample data files and keep track of names:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://github.com/OpenGeoVis/PVGeo/raw/master/tests/data/fault_points.csv&#39;</span>
<span class="n">fault_file</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">examples</span><span class="o">.</span><span class="n">downloads</span><span class="o">.</span><span class="n">_retrieve_file</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s1">&#39;fault_points.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Let’s go ahead and load a simple file that has XYZ coordinates and a boolean
array for fault presence. This point cloud makes some sort of regular grid,
but we have forgotten the deatials of the cell spacings and local coordinate
rotations.</p>
<p>We will read in this data with <code class="docutils literal notranslate"><span class="pre">pandas</span></code> and send it to the
<code class="xref py py-func docutils literal notranslate"><span class="pre">PVGeo.points_to_poly_data()</span></code> helper to create a <code class="xref py py-class docutils literal notranslate"><span class="pre">pyvista.PolyData</span></code>
object (essentially a point cloud).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fault_file</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>            X            Y       Z  Fault
0  326819.497  4407450.636  1287.5      0
1  326834.340  4407470.753  1287.5      0
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vtkpoints</span> <span class="o">=</span> <span class="n">PVGeo</span><span class="o">.</span><span class="n">points_to_poly_data</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vtkpoints</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>PolyData (0x7f5bf67739a8)
  N Cells:      499200
  N Points:     499200
  X Bounds:     3.268e+05, 3.302e+05
  Y Bounds:     4.406e+06, 4.410e+06
  Z Bounds:     1.250e+01, 1.288e+03
  N Arrays:     1
</pre></div>
</div>
<p>Note that we have a <code class="xref py py-class docutils literal notranslate"><span class="pre">pyvista.PolyData</span></code> object now which allows us to do
all types of immediate plotting of our data. First, lets threshold our points
as the point cloud has a bunch of zeros and ones throughout the dataspace to
describe the presence of a fault.</p>
<p>To threshold the points, we call the threshold filter directly on our data
object and pass the thresholding value. We can then plot the result by
calling the plot function. (Note: change the notebook parameter to
<code class="docutils literal notranslate"><span class="pre">False</span></code> for an interactive window)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vtkpoints</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">clim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">point_size</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_voxelize-points_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_voxelize-points_001.png" />
<div class="section" id="points-to-voxelized-volume">
<h2>Points to Voxelized Volume<a class="headerlink" href="#points-to-voxelized-volume" title="Permalink to this headline">¶</a></h2>
<p>The above figure is pretty cool! But its a point cloud which means out
filtering options are pretty limited. Fortunately, we know that the point
cloud represents some sort of regularlized gridded volume of data and PVGeo
has a filter to recover that volume. This will allow further volumetric
operations can be performed with other PVGeo or VTK filters.</p>
<p>Remember that these points are rotated and we do not know the cell sizes…
this is okay! The VoxelizePoints filter from PVGeo will handle the recovory of
the coordinate rotation and grid our data without running an interpolation
scheme. The VoxelizePoints filter assumes that the points are structure on some
rotated XY-plane with regular cell spacings and does the rest on its own!
Check out VoxelizePoints code docs for more details.
The full pipeline method</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Voxelizing... &#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">voxelizer</span> <span class="o">=</span> <span class="n">PVGeo</span><span class="o">.</span><span class="n">filters</span><span class="o">.</span><span class="n">VoxelizePoints</span><span class="p">()</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">voxelizer</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">vtkpoints</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;done.&#39;</span><span class="p">)</span>

<span class="c1"># Output the results</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recovered Angle (deg.): </span><span class="si">%.3f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">voxelizer</span><span class="o">.</span><span class="n">get_recovered_angle</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Recovered Cell Sizes: (</span><span class="si">%.2f</span><span class="s1">, </span><span class="si">%.2f</span><span class="s1">, </span><span class="si">%.2f</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="n">voxelizer</span><span class="o">.</span><span class="n">get_spacing</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Voxelizing... done.
Recovered Angle (deg.): 53.550
Recovered Cell Sizes: (25.00, 25.00, 25.00)
UnstructuredGrid (0x7f5bf6773108)
  N Cells:      499200
  N Points:     524064
  X Bounds:     3.268e+05, 3.302e+05
  Y Bounds:     4.406e+06, 4.410e+06
  Z Bounds:     0.000e+00, 1.300e+03
  N Arrays:     3
</pre></div>
</div>
<p>And now we can plot the voxelized volume</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_voxelize-points_002.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_voxelize-points_002.png" />
</div>
<div class="section" id="filter-volumetric-data">
<h2>Filter Volumetric Data<a class="headerlink" href="#filter-volumetric-data" title="Permalink to this headline">¶</a></h2>
<p>Now lets use one of <cite>PyVista</cite>’s filters to create slices of the thresholded
dataset. Specifically, we are using the <code class="docutils literal notranslate"><span class="pre">slice_orthogonal</span></code> filter that will
create 3 orthogonal slices through a data volume.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">slices</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">slice_orthogonal</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>MultiBlock (0x7f5bf6773b88)
  N Blocks:     3
  X Bounds:     326804.336, 330185.260
  Y Bounds:     4406253.954, 4409862.606
  Z Bounds:     0.000, 1300.000
</pre></div>
</div>
<p>And let’s use a <code class="docutils literal notranslate"><span class="pre">clip</span></code> filter:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clip</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">normal</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">normal</span><span class="o">=</span><span class="s1">&#39;-y&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p>Now display the slices and clipped volume</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">pyvista</span><span class="o">.</span><span class="n">Plotter</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">slices</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_mesh</span><span class="p">(</span><span class="n">clip</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">show_grid</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_voxelize-points_003.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_voxelize-points_003.png" />
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  29.217 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-filters-general-voxelize-points-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/26eee8aad2c1647ea7d3396af058d480/voxelize-points.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">voxelize-points.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/3ee3b4c0b3a6fd0f1716edff6464c571/voxelize-points.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">voxelize-points.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../grids/extract-topography.html" class="btn btn-neutral float-right" title="Extract Topography" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rotate-points.html" class="btn btn-neutral float-left" title="Rotate Points" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>

    </p>
  </div>

 

    <div role="contentinfo">
        © 2018,
        <a href="http://banesullivan.com">Bane Sullivan</a><br />
        <br>
        Except where noted, this work is licensed under a
        <a rel="license" href="https://opensource.org/licenses/BSD-3-Clause">
            BSD 3-Clause License
        </a>
    </div>
    <br>
    <div>
    Built with
        <a href="http://sphinx-doc.org/">Sphinx</a>
        using a
        <a href="https://github.com/snide/sphinx_rtd_theme">theme</a>
        provided by
        <a href="https://readthedocs.org">Read the Docs</a>.
    </div>
    <div role="contentinfo">
        <br>
        This documentation was automatically generated by
        <a href="https://gendocs.readthedocs.io/en/latest/">gendocs</a><br />
    </div>




</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-115959679-6', 'auto');
    ga('send', 'pageview');
    </script>

    
    

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #546E7A;
    }
  </style>


</body>
</html>