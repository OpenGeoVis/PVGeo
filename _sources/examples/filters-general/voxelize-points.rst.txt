
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/filters-general/voxelize-points.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_filters-general_voxelize-points.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_filters-general_voxelize-points.py:


Voxelize Points
~~~~~~~~~~~~~~~

This example will demonstrate how to connect a set of points defined on a
regular grid to create a `vtkUnstructuredGrid` which can be used to perform
volumetric operations.


This example demos :class:`PVGeo.filters.VoxelizePoints`

.. GENERATED FROM PYTHON SOURCE LINES 12-19

.. code-block:: Python

    # sphinx_gallery_thumbnail_number = 2
    import pandas as pd
    import pooch
    import pyvista

    import PVGeo








.. GENERATED FROM PYTHON SOURCE LINES 20-21

Download sample data files and keep track of names:

.. GENERATED FROM PYTHON SOURCE LINES 21-24

.. code-block:: Python

    url = "https://github.com/OpenGeoVis/PVGeo/raw/main/tests/data/fault_points.csv"
    file_path = pooch.retrieve(url=url, known_hash=None)








.. GENERATED FROM PYTHON SOURCE LINES 25-33

Let's go ahead and load a simple file that has XYZ coordinates and a boolean
array for fault presence. This point cloud makes some sort of regular grid,
but we have forgotten the details of the cell spacings and local coordinate
rotations.

We will read in this data with ``pandas`` and send it to the
:func:`PVGeo.points_to_poly_data` helper to create a :class:`pyvista.PolyData`
object (essentially a point cloud).

.. GENERATED FROM PYTHON SOURCE LINES 33-36

.. code-block:: Python

    points = pd.read_csv(file_path)
    print(points[0:2])





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

                X            Y       Z  Fault
    0  326819.497  4407450.636  1287.5      0
    1  326834.340  4407470.753  1287.5      0




.. GENERATED FROM PYTHON SOURCE LINES 37-41

.. code-block:: Python


    vtkpoints = PVGeo.points_to_poly_data(points)
    vtkpoints






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table style='width: 100%;'><tr><th>Header</th><th>Data Arrays</th></tr><tr><td>
    <table style='width: 100%;'>
    <tr><th>PolyData</th><th>Information</th></tr>
    <tr><td>N Cells</td><td>499200</td></tr>
    <tr><td>N Points</td><td>499200</td></tr>
    <tr><td>N Strips</td><td>0</td></tr>
    <tr><td>X Bounds</td><td>3.268e+05, 3.302e+05</td></tr>
    <tr><td>Y Bounds</td><td>4.406e+06, 4.410e+06</td></tr>
    <tr><td>Z Bounds</td><td>1.250e+01, 1.288e+03</td></tr>
    <tr><td>N Arrays</td><td>1</td></tr>
    </table>

    </td><td>
    <table style='width: 100%;'>
    <tr><th>Name</th><th>Field</th><th>Type</th><th>N Comp</th><th>Min</th><th>Max</th></tr>
    <tr><td><b>Fault</b></td><td>Points</td><td>float64</td><td>1</td><td>0.000e+00</td><td>1.000e+00</td></tr>
    </table>

    </td></tr> </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 42-51

Note that we have a :class:`pyvista.PolyData` object now which allows us to do
all types of immediate plotting of our data. First, lets threshold our points
as the point cloud has a bunch of zeros and ones throughout the dataspace to
describe the presence of a fault.

To threshold the points, we call the threshold filter directly on our data
object and pass the thresholding value. We can then plot the result by
calling the plot function. (Note: change the notebook parameter to
``False`` for an interactive window)

.. GENERATED FROM PYTHON SOURCE LINES 51-53

.. code-block:: Python

    vtkpoints.plot(clim=[0, 1], point_size=1)








.. tab-set::



   .. tab-item:: Static Scene



            
     .. image-sg:: /examples/filters-general/images/sphx_glr_voxelize-points_001.png
        :alt: voxelize points
        :srcset: /examples/filters-general/images/sphx_glr_voxelize-points_001.png
        :class: sphx-glr-single-img
     


   .. tab-item:: Interactive Scene



       .. offlineviewer:: /home/runner/work/PVGeo/PVGeo/docs/source/examples/filters-general/images/sphx_glr_voxelize-points_001.vtksz






.. GENERATED FROM PYTHON SOURCE LINES 54-70

Points to Voxelized Volume
++++++++++++++++++++++++++

The above figure is pretty cool! But it is a point cloud which means out
filtering options are pretty limited. Fortunately, we know that the point
cloud represents some sort of regularized gridded volume of data and PVGeo
has a filter to recover that volume. This will allow further volumetric
operations can be performed with other PVGeo or VTK filters.

Remember that these points are rotated and we do not know the cell sizes...
this is okay! The VoxelizePoints filter from PVGeo will handle the recovery of
the coordinate rotation and grid our data without running an interpolation
scheme. The VoxelizePoints filter assumes that the points are structured on some
rotated XY-plane with regular cell spacings and does the rest on its own!
Check out VoxelizePoints code docs for more details.
The full pipeline method

.. GENERATED FROM PYTHON SOURCE LINES 70-80

.. code-block:: Python

    print("Voxelizing... ", end="")
    voxelizer = PVGeo.filters.VoxelizePoints()
    grid = voxelizer.apply(vtkpoints)
    print("done.")

    # Output the results
    print("Recovered Angle (deg.): %.3f" % voxelizer.get_angle())
    print("Recovered Cell Sizes: (%.2f, %.2f, %.2f)" % voxelizer.get_spacing())
    grid





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Voxelizing... done.
    Recovered Angle (deg.): 53.550
    Recovered Cell Sizes: (25.00, 25.00, 25.00)


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table style='width: 100%;'><tr><th>Header</th><th>Data Arrays</th></tr><tr><td>
    <table style='width: 100%;'>
    <tr><th>UnstructuredGrid</th><th>Information</th></tr>
    <tr><td>N Cells</td><td>499200</td></tr>
    <tr><td>N Points</td><td>524064</td></tr>
    <tr><td>X Bounds</td><td>3.268e+05, 3.302e+05</td></tr>
    <tr><td>Y Bounds</td><td>4.406e+06, 4.410e+06</td></tr>
    <tr><td>Z Bounds</td><td>0.000e+00, 1.300e+03</td></tr>
    <tr><td>N Arrays</td><td>3</td></tr>
    </table>

    </td><td>
    <table style='width: 100%;'>
    <tr><th>Name</th><th>Field</th><th>Type</th><th>N Comp</th><th>Min</th><th>Max</th></tr>
    <tr><td><b>Fault</b></td><td>Cells</td><td>float64</td><td>1</td><td>0.000e+00</td><td>1.000e+00</td></tr>
    <tr><td>Recovered Angle (Deg.)</td><td>Fields</td><td>float64</td><td>1</td><td>5.355e+01</td><td>5.355e+01</td></tr>
    <tr><td>Recovered Cell Sizes</td><td>Fields</td><td>float64</td><td>3</td><td>2.500e+01</td><td>2.500e+01</td></tr>
    </table>

    </td></tr> </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 81-82

And now we can plot the voxelized volume

.. GENERATED FROM PYTHON SOURCE LINES 82-85

.. code-block:: Python

    grid.plot()









.. tab-set::



   .. tab-item:: Static Scene



            
     .. image-sg:: /examples/filters-general/images/sphx_glr_voxelize-points_002.png
        :alt: voxelize points
        :srcset: /examples/filters-general/images/sphx_glr_voxelize-points_002.png
        :class: sphx-glr-single-img
     


   .. tab-item:: Interactive Scene



       .. offlineviewer:: /home/runner/work/PVGeo/PVGeo/docs/source/examples/filters-general/images/sphx_glr_voxelize-points_002.vtksz






.. GENERATED FROM PYTHON SOURCE LINES 86-92

Filter Volumetric Data
++++++++++++++++++++++

Now lets use one of `PyVista`'s filters to create slices of the thresholded
dataset. Specifically, we are using the ``slice_orthogonal`` filter that will
create 3 orthogonal slices through a data volume.

.. GENERATED FROM PYTHON SOURCE LINES 92-95

.. code-block:: Python

    slices = grid.slice_orthogonal()
    slices






.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <table style='width: 100%;'><tr><th>Information</th><th>Blocks</th></tr><tr><td>
    <table>
    <tr><th>MultiBlock</th><th>Values</th></tr>
    <tr><td>N Blocks</td><td>3</td></tr>
    <tr><td>X Bounds</td><td>326804.336, 330185.260</td></tr>
    <tr><td>Y Bounds</td><td>4406253.954, 4409862.606</td></tr>
    <tr><td>Z Bounds</td><td>0.000, 1300.000</td></tr>
    </table>

    </td><td>
    <table>
    <tr><th>Index</th><th>Name</th><th>Type</th></tr>
    <tr><th>0</th><th>YZ</th><th>PolyData</th></tr>
    <tr><th>1</th><th>XZ</th><th>PolyData</th></tr>
    <tr><th>2</th><th>XY</th><th>PolyData</th></tr>
    </table>

    </td></tr> </table>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 96-97

And let's use a ``clip`` filter:

.. GENERATED FROM PYTHON SOURCE LINES 97-99

.. code-block:: Python

    clip = grid.clip(normal="x").clip(normal="-y").threshold(0.5)








.. GENERATED FROM PYTHON SOURCE LINES 100-101

Now display the slices and clipped volume

.. GENERATED FROM PYTHON SOURCE LINES 101-107

.. code-block:: Python


    p = pyvista.Plotter()
    p.add_mesh(slices)
    p.add_mesh(clip)
    p.show_grid()
    p.show()







.. tab-set::



   .. tab-item:: Static Scene



            
     .. image-sg:: /examples/filters-general/images/sphx_glr_voxelize-points_003.png
        :alt: voxelize points
        :srcset: /examples/filters-general/images/sphx_glr_voxelize-points_003.png
        :class: sphx-glr-single-img
     


   .. tab-item:: Interactive Scene



       .. offlineviewer:: /home/runner/work/PVGeo/PVGeo/docs/source/examples/filters-general/images/sphx_glr_voxelize-points_003.vtksz







.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 15.963 seconds)


.. _sphx_glr_download_examples_filters-general_voxelize-points.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: voxelize-points.ipynb <voxelize-points.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: voxelize-points.py <voxelize-points.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: voxelize-points.zip <voxelize-points.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
